<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <!-- Bootstrap CSS -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-eOJMYsd53ii+scO/bJGFsiCZc+5NDVN2yr8+0RDqr0Ql0h+rP48ckxlpbzKgwra6"
      crossorigin="anonymous"
    />

    <title>Uso de Fetch</title>
    <style>
      body {
        background-color: #b1c58a;
        color: #232733;
      }
      table thead {
        background-color: #302b63;
        color: white;
      }
    </style>
  </head>
  <body>
    <div class="container mt-4 shadow-lg p3 mb-5 bg-body rounded">
      <table class="table table-bordered table-striped">
        <thead>
          <tr>
            <th>ID</th>
            <th>NAME</th>
            <th>EMAIL</th>
          </tr>
        </thead>
        <tbody id="data"></tbody>
      </table>
    </div>

    <div>
      <div
        style="
          font-weight: 600;
          font-size: larger;
          width: 80%;
          margin-left: 7rem;
        "
      >
        <p>
          Para qué sirve Fetch es una API de javascript que a través de su
          interfaz permite realizar peticiones http para obtener recursos de
          red... esta es la definición básica con la que vamos a trabajar....
          recuerden que las peticiones utilizando el protocolo http son las
          siguientes son:
          <li>-Get</li>
          <li>-Post</li>
          <li>-Put</li>
          <li>-Delete</li>
          <li>-Patch</li>
          Y otras más.... <br />
          Pero las más utilizadas son las que les acabo de comentar... en este
          caso vamos a utilizar <strong>GET</strong> es decir vamos a obtener
          datos desde una api como vemos en la siguiente pagina
          jsonplaceholder.com y vamos a mostrar datos... Este metodo representa
          una alternativa más moderna a lo que sería xml http request.
          <br />
          <br />
          <br />
          <br />
          <br />
          Fetch es el nombre de una nueva API para Javascript con la cuál
          podemos realizar peticiones HTTP asíncronas (Los patrones asíncronos
          más comunes en Javascript son:
          <br />
          <br />

          Función que se ejecuta cuando una operación asíncrona termina, como
          resultado de la misma.
          <br />
          <br />
          Promesa. Representa el resultado de una operación asíncrona.
          <br />
          <br />
          Async/Await. Azúcar sintáctico para manejar promesas de una forma más
          simple.)
          <br />
          <br />
          utilizando promesas y de forma que el código sea un poco más sencillo
          y menos verbose. La forma de realizar una petición es muy sencilla,
          básicamente se trata de llamar a fetch y pasarle por parámetro la URL
          de la petición a realizar:
          <br />
          // Realizamos la petición y guardamos la promesa
          <code style="color: white">
            <br />
            const request = fetch("/robots.txt");</code
          >
          <br />
          // Si es resuelta, entonces ejecuta esta función...
          <br />
          <code style="color: white">(function(response) { ... });</code>

          <br />
          El fetch() devolverá una que será aceptada cuando reciba una respuesta
          y sólo será rechazada si hay un fallo de red o si por alguna razón no
          se pudo completar la petición. El modo más habitual de manejar las
          promesas es utilizando .then(). Esto se suele reescribir de la
          siguiente forma, que queda mucho más simple:
          <br />
          <code style="color: white"
            >fetch("/robots.txt")
            <br />
            .then(function(response) { /** Código que <br />
            procesa la respuesta **/ });</code
          >
        </p>
      </div>
    </div>

    <!--------Script Boostrap-------->
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-JEW9xMcG8R+pH31jmWH6WWP0WintQrMb4s7ZOdauHnUtxwoG2vI5DkLtS3qm9Ekf"
      crossorigin="anonymous"
    ></script>
    <!--___________________________-->

    <script>
      let url = "https://jsonplaceholder.typicode.com/users"; //en la primera parte definimos una variable un
      //url donde hacemos referencia al origen de los datos

      fetch(url) //en la segunda línea realizamos una solicitud a esta url
        .then((response) => response.json()) //en la tercera línea se resuelve la promesa al obtener la respuesta la pasa a un
        //determinado formato utilizando la función correspondiente.. en este caso estamos utilizando json

        .then((data) => mostrarData(data)) //en la cuarta línea leemos este objeto data y lo mostramos por consola

        .catch((error) => console.log(error)); //por último en cinco si hay un error será atrapado con la palabra reservada catch

      const mostrarData = (data) => {
        //Se traen los datos
        console.log(data);
        let body = "";
        for (let i = 0; i < data.length; i++) {
          //vamos a utilizar un bucle for
          //porque sabemos de que esa data va a tener una longitud en este caso es un arreglo de 10 ELEMENTOS
          body += `<tr><td>${data[i].id}</td><td>${data[i].name}</td><td>${data[i].email}</td></tr>`;
        }
        document.getElementById("data").innerHTML = body; // Con esta linea graficamos lo de la linea 85 en el ID "data" de
      }; //la linea 37.. En cada iteracion del bucle se va creando lo estipulado
    </script>
  </body>
</html>
